export const steps = [
  {
    id: "intuition",
    title: "Intuition",
    short: "Why model price randomness?",
    description: `Stochastic differential equations represent a very powerful mathematical framework for modelling systems, and it is influenced both by deterministic forces and random fluctuations. 

In physics and finance, we understand many quantities evolve over time, from particle positions, to temperature distributions and stock prices. When the future of this evolution is perfectly predictable from initial conditions, we can use ordinary differential equations (ODEs). A simple example is exponential growth, $\\frac{dx}{dt} = kx$, which tells us exactly what $x(t)$ will be at any moment in time given the initial value and growth constant k.

However, this deterministic framework breaks down when confronted with the reality of financial markets. Markets are not clockwork mechanisms. They are influenced by an endless stream of unpredictable factors: economic news releases, geopolitical events, shifts in investor sentiment, regulatory changes, and countless individual trading decisions. Each of these introduces its own small element of randomness that cannot be captured by deterministic equations alone. To model these systems realistically, we need to use a mathematical tool that can incorporate both the underlying trends and the inherent uncertainty, and this is where stochastic differential equations enter the picture.`,
    widgetKey: "PlaceholderWidget",
    pinsByDefault: false,
  },
  {
    id: "history",
    title: "Background & History",
    short: "Origins of GBM",
    description: `Physicists have used these same ideas for a while. Many Monte Carlo techniques were first developed in physics (particularly in the Manhattan Project) before being adopted by finance. The conceptual similarities between a particle undergoing molecular collisions and a stock price buffeted by market force is remarkable.

The basic Wiener process can take negative values, which made it unsuitable for direct stock price modelling. Stock prices, after all, cannot fall below zero, a company's value may plummet, but it cannot become negative. Therefore, the mathematical framework was adapted to create Geometric Brownian Motion (GBM), which ensures price changes are proportional to the current price level.`,
    widgetKey: "PlaceholderWidget",
    pinsByDefault: false,
  },
  {
    id: "wiener",
    title: "Wiener Process W(t)",
    short: "Random walk foundation",
    description: `The term $dW$ represents an infinitesimal increment of Brownian motion, which we explored in the previous section. This is the source of all randomness in the equation. 

Mathematically, $dW$ behaves like $\\sqrt{dt}$ multiplied by a standard normal random variable Z. This scaling is important, because it means that over longer time intervals, the random effects accumulate in a specific way, growing proportionally to the square root of time rather than linearly. This is fundamentally different from deterministic systems and reflects the diffusive nature of random processes.

One might wonder why we write $dX$ rather than a traditional derivative like $\\frac{dx}{dt}$. This is because paths generated by SDEs are typically not differentiable in the classical sense. Brownian motion, despite being continuous, has such irregular, jagged paths that they have an infinite variation, so you cannot compute a traditional derivative at any point. The notation $dX$ represents an infinitesimal change interpreted in a specific mathematical sense, either through Itô calculus or Stratonovich calculus (but those are far too complex for you to do at this stage), which provide rigorous foundations for manipulating these objects.`,
    widgetKey: "WienerWidget",
    pinsByDefault: true,
  },
  {
    id: "sde",
    title: "SDE Formulation",
    short: "Stochastic differential equation",
    description: `A stochastic differential equation combines two fundamentally different components, a deterministic part which represents what would happen on average, and a stochastic part capturing unpredictable fluctuations. The general form of an SDE can be written as:
$dX = a(X,t)dt + b(X,t)dW$

This deceptively simple equation is a lot more sophisticated than it may look. The term $a(X,t)$ is called the drift coefficient. It represents the deterministic tendency of the system, essentially the direction and rate at which X would evolve in the absence of any random perturbations. In a financial context, this might represent the expected return on an asset. The drift can depend on both the current state X and time t, allowing for complex, path-dependent behaviour.

The term $b(X,t)$ is the diffusion coefficient, sometimes called the volatility function. It determines the magnitude of random fluctuations, essentially, how much the system can be knocked around by random forces. Crucially, this can also depend on the current state, meaning that uncertainty itself can be state-dependent. In financial markets, we often observe that volatility increases during periods of market stress, for example an asset that has fallen sharply would likely exhibit greater price swings than one trading calmly.`,
    widgetKey: "PlaceholderWidget",
    pinsByDefault: false,
  },
  {
    id: "gbm-solution",
    title: "GBM Solution & Discretization",
    short: "Closed-form GBM path",
    description: `The GBM model is: $dS = \\mu Sdt + \\sigma SdW$. This seemingly small modification, multiplying both drift and diffusion terms by S, has some profound consequences. The parameter $\\mu$ represents the average growth rate or expected return of the asset. This is the deterministic trend component. If we removed all randomness (set $\\sigma = 0$), the solution would be simple exponential growth: $S(t) = S_0 e^{\\mu t}$.

The parameter $\\sigma$ represents the volatility, a measure of how severely and frequently the price fluctuates around its trend. The key insight is that volatility is multiplicative, and it scales with the current price S. 

Figure 1: Effect of volatility on price paths. Three simulations with identical drift ($\\mu=0.08$) but increasing volatility ($\\sigma=0.1, 0.2, 0.4$). Higher volatility creates larger fluctuations around the trend.

The multiplicative structure ensures that S remains strictly positive for all time, provided it starts positive. This is a mathematical guarantee that emerges from the properties of the exponential function. Even if the random term $dW$ pushes strongly negative in a particular instant, the proportional nature of the equation prevents the price from crossing zero. The percentage change in price can certainly be negative when the stock falls, but the price itself has a natural floor at zero.

To solve SDEs numerically, we use the Euler-Maruyama method. We divide the time interval [0, T] into N small steps of size $\\Delta t = T/N$ and use a discrete-time recursion:
$X(t + \\Delta t) = X(t) + a(X(t),t)\\Delta t + b(X(t),t)\\sqrt{\\Delta t}Z$

For Geometric Brownian Motion specifically, the scheme becomes:
$S(t + \\Delta t) = S(t) + \\mu S(t)\\Delta t + \\sigma S(t)\\sqrt{\\Delta t}Z$`,
    widgetKey: "GBMSinglePathWidget",
    pinsByDefault: true,
  },
  {
    id: "simulation",
    title: "Simulation",
    short: "Many paths at once",
    description: `A single simulated path doesn't tell us much. It only represents one possible future out of infinitely many. The true power of stochastic simulation comes from generating many paths and analysing their statistical properties. This is where Monte Carlo comes in.

The procedure is as follows, we run the Euler-Maruyama algorithm thousands or millions of times, each time with independently drawn random numbers. Each run produces a different trajectory $S_1(t), S_2(t), ..., S_m(t)$. From this group of runs, we can compute the mean final price, the variance, percentiles for risk assessment, probabilities of extreme outcomes etc.

For example, to estimate the probability that a stock price exceeds £150 after one year, (given $S_0 = £100, \\mu = 0.08, and \\sigma = 0.20$), we simulate 100,000 paths and count how many of these paths satisfy $S(1) > 150$. The fraction of paths meeting this criterion provides an estimate of the desired probability.

Figure 2: Monte Carlo simulation showing 100 possible price paths over one year. Each path uses the same parameters ($S_0=£100, \\mu=0.08, \\sigma=0.2$) but different random numbers, illustrating the range of possible outcomes.

Monte Carlo methods are particularly valuable because they scale well to high-dimensional problems. For a portfolio of n correlated assets, we can simply simulate all processes simultaneously at each time step.`,
    widgetKey: "GBMManyPathsWidget",
    pinsByDefault: false,
  },
  {
    id: "terminal-distribution",
    title: "Terminal Distribution",
    short: "Lognormal at time T",
    description: `Although the GBM model provides the foundation for the Black-Scholes option pricing formula, it has well-documented shortcomings when confronted with real market data. Geometric Brownian Motion is excellent for modelling small-scale, continuous random fluctuations, but it is fundamentally poor at capturing the extreme market movements that matter most for risk management.

The problem lies in the assumption of continuous paths. In GBM, prices evolve smoothly as an accumulation of many small steps, and there are no sudden jumps. However, real financial markets exhibit fat tails. Extreme events occur far more frequently than the normal distribution predicts. The 1987 Black Monday crash, the 2008 financial crisis, and the March 2020 COVID-19 market crash all involved movements that GBM would assign probabilities of less than one in several million years.

Furthermore, GBM assumes constant volatility $\\sigma$, independent of price level or time. Typically, we know high volatility periods tend to be followed by more high volatility. Volatility also typically increases when markets fall, known as the leverage effect. To address these limitations, researchers have developed more sophisticated models, but GBM remains a useful starting point for understanding market dynamics.`,
    widgetKey: "TerminalDistributionWidget",
    pinsByDefault: true,
  },
  {
    id: "decision-theory",
    title: "Decision Theory",
    short: "Expected loss minimization",
    description: `Our project applies the SDE framework to model how asset prices respond to climate-related uncertainty and events. Under normal conditions, asset prices follow:
$dS = \\mu S dt + \\sigma_0 S dW$
Here, $\\mu$ is the expected return and $\\sigma_0$ is the baseline volatility level.

When a climate-related event occurs, be it an extreme heatwave disrupting energy supply, a major policy shift towards renewable energy, or a catastrophic Fukushima scale disaster, we model the market response by altering the SDE parameters. This approach is known as regime-switching.

The first parameter change is to volatility. We increase it from $\\sigma_0$ to $\\sigma_0(1 + c)$, where c is a positive multiplier representing the additional uncertainty introduced by the climate event. For example, if c = 0.5, volatility increases by 50%. This reflects how uncertainty spikes during crises, investors face greater ambiguity and the asset fluctuates more violently.

The second parameter that may change is the drift $\\mu$. If a climate event causes investors to fundamentally reassess an asset's long-term prospects, the expected return can shift. A pro-renewable energy policy might increase $\\mu$ for solar and wind companies. In our model, the drift changes from $\\mu$ to $\\mu_{new}$, where the direction and magnitude of the change depend on the nature of the event and the sector in question.

Mathematically, the post-event dynamics become:
$dS = \\mu_{new} S dt + \\sigma_0(1 + c)S dW$

We implement this using Monte Carlo simulation. For the baseline scenario, we simulate M paths using the original parameters ($\\mu, \\sigma_0$). For the event scenario, we simulate M paths using the modified parameters ($\\mu_{new}, \\sigma_0(1 + c)$). From these simulated groups, we can construct distributions of portfolio values and compare them. The SDE framework thus provides a rigorous, quantitative language for translating qualitative climate concerns into concrete financial risk assessments.`,
    widgetKey: "DecisionTheoryWidget",
    pinsByDefault: false,
  },
];

export const stepOrder = steps.map((s) => s.id);

export function getStepById(id) {
  return steps.find((s) => s.id === id) ?? null;
}